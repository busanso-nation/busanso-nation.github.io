<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Series Player</title>
<style>
    body { margin:0; font-family: Arial,sans-serif; background:#121212; color:#fff; }
    .player-container { max-width:1000px; margin:20px auto; padding:0 10px; }
    h1, p { margin:0 0 10px 0; }
    .video-wrapper { position:relative; width:100%; padding-top:56.25%; background:#000; margin-bottom:20px; }
    iframe { position:absolute; top:0; left:0; width:100%; height:100%; border:none; }
    .episode-list { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:20px; }
    .episode-list button { flex:1 1 calc(33.333% - 10px); padding:10px; background:#1f1f1f; border:none; color:#fff; cursor:pointer; border-radius:6px; transition:0.3s; }
    .episode-list button.active, .episode-list button:hover { background:#ff3b3b; }
    .controls { display:flex; justify-content:space-between; margin-bottom:20px; }
    .controls button { padding:8px 12px; background:#ff3b3b; border:none; color:#fff; border-radius:5px; cursor:pointer; }
    .ad-banner { width:100%; height:100px; background:#333; display:flex; justify-content:center; align-items:center; font-weight:bold; margin-bottom:20px; }
    @media(max-width:768px){ .episode-list button{ flex:1 1 calc(50% - 10px); } }
    @media(max-width:480px){ .episode-list button{ flex:1 1 100%; } }
</style>
</head>
<body>

<div class="player-container">
    <h1 id="series-title"></h1>
    <p id="series-desc"></p>

    <div class="video-wrapper">
        <iframe id="video-player" src="" allowfullscreen allow="autoplay; encrypted-media"></iframe>
    </div>

    <div class="controls">
        <button id="prev-episode">Prev Episode</button>
        <button id="next-episode">Next Episode</button>
    </div>

    <div class="episode-list" id="episode-list"></div>

    <div class="ad-banner">Your Banner Ad Here</div>
</div>

<script src="series-data.js"></script>
<script>
    const player = document.getElementById("video-player");
    const episodeList = document.getElementById("episode-list");
    const seriesTitle = document.getElementById("series-title");
    const seriesDesc = document.getElementById("series-desc");
    let currentEpisode = 0;

    // Load series info
    seriesTitle.textContent = seriesData.title;
    seriesDesc.textContent = seriesData.description;

    function loadEpisode(index) {
        if(index < 0) index = seriesData.episodes.length - 1;
        if(index >= seriesData.episodes.length) index = 0;
        currentEpisode = index;
        player.src = seriesData.episodes[index].url;
        updateActiveButton();
        localStorage.setItem(seriesData.title + '_currentEpisode', currentEpisode);
    }

    function updateActiveButton() {
        episodeList.querySelectorAll("button").forEach((btn,i)=>{
            btn.classList.toggle("active", i===currentEpisode);
        });
    }

    // Populate episode buttons
    seriesData.episodes.forEach((ep,index)=>{
        const btn = document.createElement("button");
        btn.textContent = ep.title;
        btn.addEventListener("click",()=>loadEpisode(index));
        episodeList.appendChild(btn);
    });

    // Prev/Next buttons
    document.getElementById("prev-episode").addEventListener("click",()=>loadEpisode(currentEpisode-1));
    document.getElementById("next-episode").addEventListener("click",()=>loadEpisode(currentEpisode+1));

    // Auto resume last episode
    const savedEpisode = localStorage.getItem(seriesData.title + '_currentEpisode');
    loadEpisode(savedEpisode ? parseInt(savedEpisode) : 0);

    // Optional: Auto-next for YouTube and Vimeo using their APIs
    function setupAutoNext(){
        if(player.src.includes("youtube.com")){
            const tag=document.createElement('script');
            tag.src="https://www.youtube.com/iframe_api";
            document.body.appendChild(tag);
            window.onYouTubeIframeAPIReady=()=>{
                new YT.Player('video-player',{
                    events:{
                        'onStateChange':(e)=>{
                            if(e.data===YT.PlayerState.ENDED) loadEpisode(currentEpisode+1);
                        }
                    }
                });
            }
        }
        if(player.src.includes("vimeo.com")){
            const script=document.createElement('script');
            script.src="https://player.vimeo.com/api/player.js";
            document.body.appendChild(script);
            script.onload=()=>{
                const vimeoPlayer = new Vimeo.Player(player);
                vimeoPlayer.on('ended',()=>loadEpisode(currentEpisode+1));
            }
        }
    }
    setupAutoNext();
</script>

</body>
</html>
