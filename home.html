<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Busanso Nation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- DATA FILES -->
<script src="movies-data.js"></script>
<script src="series-data.js"></script>

<style>
body{
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:'Poppins',sans-serif;
}

/* STICKY HEADER + TOP BUTTONS */
.sticky-header{
  position:sticky;
  top:0;
  background:#0b0b0b;
  z-index:999;
  padding-bottom:5px;
  box-shadow:0 2px 8px rgba(0,0,0,.6);
}
.header{
  padding:10px;
  text-align:center;
}
.header h1{
  margin:0;
  font-size:22px;
  font-weight:700;
}
.header img{
  height:50px;
  margin-top:6px;
}

/* TOP BUTTONS */
.top-actions{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:10px;
  padding:8px 10px 10px;
  background:#0b0b0b;
}
.btn{
  padding:10px 18px;
  border-radius:999px;
  font-weight:700;
  font-size:12px;
  color:#fff;
  text-decoration:none;
  box-shadow:0 5px 14px rgba(0,0,0,.4);
  border:1px solid rgba(255,255,255,.08);
}
.subscribe{ background:#e50914; }
.login{ background:#2563eb; }
.about{ background:#111; color:#ddd; }
.library{ background:#facc15; color:#000; }
.kibanda{ background:#14b8a6; color:#002; }

/* MAIN CONTENT */
.main-content{
  padding:12px 0 70px; /* bottom padding for sticky footer */
  overflow:auto;
}

/* SECTIONS */
.section{ padding:12px; }
.slider{
  display:flex;
  gap:10px;
  overflow-x:auto;
}
.slider::-webkit-scrollbar{ display:none; }

/* CARDS â€“ MOBILE FIRST (3 visible) */
.card{
  width:32vw;
  max-width:130px;
  flex-shrink:0;
  text-align:center;
}
.card img{
  width:100%;
  border-radius:7px;
}
.card-title{
  font-size:12px;
  margin-top:4px;
  font-weight:600;
}
.watch-btn{
  width:100%;
  margin-top:4px;
  padding:6px;
  font-size:11px;
  border:none;
  border-radius:6px;
  background:#e50914;
  color:#fff;
  font-weight:700;
}

/* BADGE */
.badge{
  position:absolute;
  top:5px;
  left:5px;
  font-size:9px;
  padding:2px 5px;
  border-radius:6px;
  background:#22c55e;
}
.badge.premium{ background:#e50914; }

.lock-icon{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.6);
  font-size:11px;
  font-weight:700;
}

/* TABLET / PC */
@media(min-width:768px){
  .card{ width:160px; max-width:160px; }
}
/* SMART TV / LARGE */
@media(min-width:1200px){
  .card{ width:190px; max-width:190px; }
}

/* INSTALL BUTTON */
#installBtn{
  position:fixed;
  bottom:60px;
  right:20px;
  padding:14px 18px;
  border-radius:50px;
  font-size:16px;
  font-weight:700;
  border:none;
  background:#ff7a18;
  color:#fff;
  cursor:pointer;
  z-index:9999;
}

#iosHint{
  position:fixed;
  bottom:20px;
  left:20px;
  right:20px;
  background:#ff7a18;
  padding:12px;
  border-radius:12px;
  font-size:14px;
  text-align:center;
  display:none; /* keep this hidden */
  z-index:9999;
}
#installBtn{
  box-shadow:0 0 10px #ff7a18,
             0 0 20px #ff7a18,
             0 0 40px rgba(255,122,24,.6);
  animation: glowPulse 2s infinite ease-in-out;
  transition: transform .2s ease;
}

#installBtn:hover{
  transform: scale(1.08);
}

@keyframes glowPulse{
  0%{
    box-shadow:0 0 5px #ff7a18,
               0 0 15px #ff7a18;
  }
  50%{
    box-shadow:0 0 20px #ffae42,
               0 0 40px #ff7a18;
  }
  100%{
    box-shadow:0 0 5px #ff7a18,
               0 0 15px #ff7a18;
  }
}


/* FOOTER BUTTONS */
.footer-actions{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  display:flex;
  justify-content:space-around;
  background:#111;
  padding:8px 0;
  box-shadow:0 -2px 10px rgba(0,0,0,.6);
  z-index:999;
}
.footer-actions .btn{
  padding:10px 15px;
  font-size:12px;
}
/* WHATSAPP FLOATING BUTTON */
.whatsapp-float{
  position:fixed;
  right:20px;
  bottom:110px; /* above footer */
  width:65px;
  height:65px;
  border-radius:50%;
  background:#25D366;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 8px 25px rgba(0,0,0,.5);
  z-index:9999;
  transition:transform .2s ease, box-shadow .2s ease;
}

.whatsapp-float:hover{
  transform:translateY(-4px) scale(1.08);
  box-shadow:0 12px 35px rgba(0,0,0,.7);
}

.whatsapp-float img{
  width:30px;
  height:30px;
}

</style>
</head>

<body>

<!-- STICKY HEADER + TOP BUTTONS -->
<div class="sticky-header">
  <div class="header">
    <h1>Busanso Nation</h1>
    <img src="https://i.ibb.co/hxgrLF35/BUSANSO-New.png">
  </div>
  <div class="top-actions">
    <a href="packages.html" class="btn subscribe">Pay to Watch</a>
    <a href="login.html" class="btn login">Login</a>
    <a href="about.html" class="btn about">Are You New?</a>
    <a href="library-login.html" class="btn library">Library</a>
    <a href="kibanda-login.html" class="btn kibanda">Kibanda</a>
  </div>
</div>

<!-- SCROLLABLE CONTENT -->
<div class="main-content">
  <div class="section">
    <h3>Latest Movies</h3>
    <div class="slider" id="moviesBox"></div>
  </div>

  <div class="section">
    <h3>Latest Series</h3>
    <div class="slider" id="seriesBox"></div>
  </div>

  <!-- BOTTOM BANNER AD -->
  <div class="ad-banner" style="text-align:center; margin:25px 0;">
    <script>
      atOptions = {
        'key' : '1c9ccdb756a82c4d663014a338917bd7',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'params' : {}
      };
    </script>
    <script src="https://www.highperformanceformat.com/1c9ccdb756a82c4d663014a338917bd7/invoke.js"></script>
  </div>

  <div class="section">
    <h3>Free Movies</h3>
    <div class="slider" id="freeMoviesBox"></div>
  </div>

  <div class="section">
    <h3>Free Series</h3>
    <div class="slider" id="freeSeriesBox"></div>
  </div>
</div>
<button id="audioToggle" title="Mute / Unmute" style="
  position: fixed;
  bottom: 180px;
  right: 20px;
  background: rgba(255,255,255,0.2);
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  font-size: 24px;
  color: #fff;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  box-shadow: 0 0 10px rgba(255,255,255,0.4);
  transition: 0.3s;
">ðŸ”Š</button>

<!-- INSTALL APP -->
<button id="installBtn">Install App</button>
<div id="iosHint">Tap <strong>Share â†’ Add to Home Screen</strong></div>

<!-- FOOTER STICKY BUTTONS -->
<div class="footer-actions">
  <a href="live.html" class="btn live">Live</a>
  <a href="agents.html" class="btn agents">Our Agents</a>
  <a href="home.html" class="btn home">Home</a>
</div>

<script>
/* ===== PIN REDIRECT (UNCHANGED) ===== */
(function(){
  var pin = localStorage.getItem("activePIN");
  var exp = Number(localStorage.getItem("pinExpiry"));
  if(pin && exp && Date.now() < exp){
    location.replace("watch.html");
  }
})();

/* ===== CARD CREATOR (UNCHANGED LOGIC) ===== */
function createCard(item,type){
  var isPremium=item.type==="premium";
  var card=document.createElement("div");
  card.className="card";
  card.innerHTML=
  '<div style="position:relative">'+
  '<img src="'+item.poster+'">'+
  '<span class="badge '+(isPremium?'premium':'')+'">'+
  (isPremium?'PREMIUM':'FREE')+
  '</span>'+
  (isPremium?'<div class="lock-icon">LOCKED</div>':'')+
  '</div>'+
  '<div class="card-title">'+item.title+'</div>'+
  '<button class="watch-btn">'+(isPremium?'Pay to Watch':'Watch')+'</button>';

  card.querySelector(".watch-btn").onclick=function(){
    if(isPremium) location.href="packages.html";
    else location.href=(type==="movie"?"movie.html?id=":"serie.html?id=")+item.id;
  };
  return card;
}

/* ===== RENDER ALL ===== */
MOVIES.forEach(m=>{
  moviesBox.appendChild(createCard(m,"movie"));
  if(m.type!=="premium") freeMoviesBox.appendChild(createCard(m,"movie"));
});
SERIES.forEach(s=>{
  seriesBox.appendChild(createCard(s,"series"));
  if(s.type!=="premium") freeSeriesBox.appendChild(createCard(s,"series"));
});

/* ===== INSTALL LOGIC (UNCHANGED) ===== */
let deferredPrompt;
const installBtn = document.getElementById("installBtn");

/* Detect if already installed */
function isStandalone() {
  return window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;
}

/* If app is already installed */
if (isStandalone()) {
  installBtn.textContent = "Open App";
  installBtn.onclick = () => {
    window.location.href = "home.html"; // or your main app page
  };
} 
else {

  /* Capture install availability */
  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;
  });

  installBtn.onclick = async () => {

    if (deferredPrompt) {
      deferredPrompt.prompt();
      const result = await deferredPrompt.userChoice;

      if (result.outcome === "accepted") {
        installBtn.textContent = "Open App";
      }

      deferredPrompt = null;
    } 
    else {
      // fallback for iPhone
      window.location.href = "install.html";
    }

  };
  
}

</script>

<script src="https://pl28597623.effectivegatecpm.com/47/af/6b/47af6bb4248b5c79dabea6b329d6d72f.js"></script>
<!-- WHATSAPP FLOATING BUTTON -->
<a href="https://wa.me/256703888884" 
   class="whatsapp-float" 
   target="_blank">
   <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
</a>
<audio id="bgAudio" loop>
  <source src="backgrou.mp3" type="audio/mpeg">
</audio>
<script>
const bgAudio = document.getElementById("bgAudio");
bgAudio.volume = 0.3; // soft background volume

function startAudio() {
  bgAudio.play().catch(() => {}); // safely ignore autoplay restrictions
  document.removeEventListener("click", startAudio);
}

// Wait for first user interaction (required by mobile/autoplay policies)
document.addEventListener("click", startAudio);
</script>

<script>
const bgAudio = document.getElementById("bgAudio");
const audioToggle = document.getElementById("audioToggle");
let isMuted = false;

// Set initial volume
bgAudio.volume = 0.3;

// Start audio on first click (required on mobile)
function startAudio() {
  bgAudio.play().catch(() => {});
  document.removeEventListener("click", startAudio);
}
document.addEventListener("click", startAudio);

// Toggle mute/unmute
audioToggle.onclick = () => {
  isMuted = !isMuted;
  bgAudio.muted = isMuted;
  audioToggle.textContent = isMuted ? "ðŸ”‡" : "ðŸ”Š"; // change icon
};
</script>

</body>
</html>
