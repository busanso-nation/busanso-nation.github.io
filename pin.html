<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BUSANSO NATION</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

   <!-- Firebase config -->
<script>
const firebaseConfig = {
  apiKey: "AIzaSyBGGV9F3Nv13nRJ8t4QCP5Y0IosmKfYz1s",
  authDomain: "busanso-pins.firebaseapp.com",
  databaseURL: "https://busanso-pins-default-rtdb.firebaseio.com/",
  projectId: "busanso-pins",
  storageBucket: "busanso-pins.firebasestorage.app",
  messagingSenderId: "137040014808",
  appId: "1:137040014808:web:b0684e17b6b0328da596ad"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
</script>


    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            height: 100vh;
            background: radial-gradient(circle at top, #102a1d, #000);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .splash {
            text-align: center;
            color: #fff;
            animation: fadeOut 1s ease forwards;
            animation-delay: 5s;
        }

        .logo {
            font-size: 3rem;
            letter-spacing: 4px;
            font-weight: 800;
            animation: zoomIn 2s ease forwards, glow 3s ease-in-out infinite;
        }

        .nation { color: #e50914; }

        .tagline {
            margin-top: 14px;
            font-size: 1.1rem;
            opacity: 0;
            animation: fadeIn 2s ease forwards;
            animation-delay: 1.5s;
            color: #f1c40f;
        }

        .message {
            margin-top: 10px;
            font-size: 0.95rem;
            opacity: 0;
            animation: fadeIn 2s ease forwards;
            animation-delay: 2.5s;
            color: #dcdcdc;
        }

        .loader {
            margin: 35px auto 0;
            width: 42px;
            height: 42px;
            border: 4px solid rgba(255,255,255,0.2);
            border-top: 4px solid #f1c40f;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.6); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes fadeOut { to { opacity: 0; } }

        @keyframes glow {
            0%,100% { text-shadow: 0 0 10px rgba(241,196,15,0.4); }
            50% { text-shadow: 0 0 25px rgba(241,196,15,0.8); }
        }
    </style>
</head>

<body>

<div class="splash">
    <div class="logo">
        BUSANSO <span class="nation">NATION</span>
    </div>

    <div class="tagline">
        Welcome Back, Uganda üá∫üá¨
    </div>

    <div class="message">
        Elections are over ‚Äî let‚Äôs unite & relax and enjoy quality entertainment
    </div>

    <div class="loader"></div>
</div>

<script>
/* ================= DEVICE ID ================= */
function getDeviceId() {
    let id = localStorage.getItem("deviceId");
    if (!id) {
        id = "dev_" + Math.random().toString(36).substr(2, 9);
        localStorage.setItem("deviceId", id);
    }
    return id;
}

/* ================= SPLASH CHECK ================= */
async function checkPinAndRedirect() {
    const activePin = localStorage.getItem("activePin");
    const deviceId = getDeviceId();

    if (!activePin) {
        location.href = "home.html";
        return;
    }

    const snap = await firebase.database()
        .ref("pins/" + activePin)
        .get();

    if (!snap.exists()) {
        localStorage.removeItem("activePin");
        location.href = "home.html";
        return;
    }

    const data = snap.val();

    if (data.usedBy === deviceId) {
        location.href = "watch.html";
    } else {
        localStorage.removeItem("activePin");
        location.href = "home.html";
    }
}

/* ‚è≥ Let splash play, then decide */
setTimeout(checkPinAndRedirect, 5500);
</script>

</body>
</html>
